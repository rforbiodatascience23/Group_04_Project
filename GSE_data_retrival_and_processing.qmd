---
title: "GSE_data_retrival_and_processing"
format: html
editor: visual
---

## Getting libraries

```{r}
library(GEOquery)
library(limma)
library(tidyverse)
library(edgeR)

```

## Loading data

```{r}
gse_data <- getGEO(GEO = "GSE39833")[[1]]

exp_data <- exprs(gse_data) #extracting expression values (Limma)

gpl <- Table(getGEO("GPL14767"))
```

## Tidying data

```{r}
gse_data_frame <- as.data.frame(exp_data) |> 
  rownames_to_column(var = "ID")

gpl <- gpl |> 
  mutate(ID = as.character(ID))

mirna_exp <- gse_data_frame |> 
  left_join(gpl, by = "ID") |> 
  select( ,-1)

patient_stage <- pData(gse_data) |> #Extracting phenoData (limma)
  select(source_name_ch1, characteristics_ch1.4) |> 
  mutate(group = if_else(characteristics_ch1.4 == "tnm stages: normal", "control", "cancer"))

```
